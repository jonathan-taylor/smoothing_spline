Search.setIndex({"alltitles": {"1. The Smoothing Spline Problem": [[2, "the-smoothing-spline-problem"]], "1. Using smoothing_spline (Python)": [[0, "1.-Using-smoothing_spline-(Python)"]], "2. Matrix Formulation": [[2, "matrix-formulation"]], "2. Using smooth.spline (R)": [[0, "2.-Using-smooth.spline-(R)"]], "3. Degrees of Freedom ($df$)": [[2, "degrees-of-freedom-df"]], "4. Comparison with R\u2019s smooth.spline": [[2, "comparison-with-r-s-smooth-spline"]], "5. References": [[2, "references"]], "A. The Basis Form (Used in this Package)": [[2, "a-the-basis-form-used-in-this-package"]], "Another Example: Log-Transformation": [[0, "Another-Example:-Log-Transformation"]], "Automatic Tuning with GCV": [[0, "Automatic-Tuning-with-GCV"]], "B. The Reinsch Form (Used in R\u2019s smooth.spline)": [[2, "b-the-reinsch-form-used-in-r-s-smooth-spline"]], "Comparing smoothing_spline with R\u2019s smooth.spline": [[0, null]], "Comparison": [[0, "Comparison"]], "Contents:": [[1, null]], "Fitting Smoothing Splines": [[0, "Fitting-Smoothing-Splines"]], "In Python (smoothing_spline)": [[0, "In-Python-(smoothing_spline)"]], "In R": [[0, "In-R"]], "Key Differences": [[2, "key-differences"]], "Limited knots": [[0, "Limited-knots"]], "Loading the Data": [[0, "Loading-the-Data"]], "Reinsch Form vs. Basis Form": [[2, "reinsch-form-vs-basis-form"]], "Setup": [[0, "Setup"]], "Smoothing Spline Documentation": [[1, null]], "Smoothing Splines: Theory and Implementation": [[2, null]], "Speed Comparison": [[0, "Speed-Comparison"]], "Synthetic Speed Comparison (N=500)": [[0, "Synthetic-Speed-Comparison-(N=500)"]], "The Solution: Natural Cubic Spline": [[2, "the-solution-natural-cubic-spline"]]}, "docnames": ["compare_R", "index", "theory"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["compare_R.ipynb", "index.md", "theory.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": 1, "0": [0, 2], "000": 2, "003490": 0, "019134": 0, "029708": 0, "034658": 0, "041208": 0, "046565": 0, "047195": 0, "05": 0, "09998": 0, "1": 1, "10": [0, 2], "100": 0, "10000": 0, "10044204963742": 0, "11": 0, "12": 0, "13": 0, "14": 0, "15": 0, "1524167755954249": 0, "16": 0, "16059": 0, "18": 0, "180087": 0, "1994": 2, "2": 1, "200": 0, "2009": 2, "202": 0, "203926": 0, "22": 0, "23": 0, "231578": 0, "24": 0, "27": 0, "2727": 0, "287174": 0, "2879": 0, "29": 0, "2f": 0, "2nd": 2, "3": [0, 1], "31": 0, "32": 0, "38": 0, "4": [0, 1], "40": 0, "44359": 0, "47623": 0, "47632": 0, "480134": 0, "49": 0, "5": [0, 1], "50": 0, "500": 1, "502": 0, "504108e": 0, "56": 0, "6": 0, "69": 0, "6f": 0, "7": 0, "75": 0, "757": 0, "8": 0, "80": 0, "81": 0, "81831": 0, "86": 0, "88": 0, "9": 0, "91756": 0, "920057": 0, "A": 0, "For": [0, 2], "If": 2, "In": 2, "It": 2, "Not": 2, "One": 0, "The": [0, 1], "There": 2, "To": 0, "_": 2, "_cpp_fitter": 0, "ab": 0, "about": 0, "absolut": 0, "abstract": 2, "access": 0, "add": 0, "algorithm": 2, "all": [0, 2], "allow": 2, "alpha": 0, "alreadi": 0, "also": [0, 2], "an": 2, "anoth": 1, "approach": 2, "ar": [0, 2], "argsort": 0, "around": 0, "atemp": 0, "automat": [1, 2], "avail": 0, "avoid": 0, "ax": 0, "b": 0, "backend": 2, "background": 2, "band": 2, "basi": 0, "becaus": 2, "becom": 2, "behavior": 0, "best_df": 0, "best_lam": 0, "best_lam_sc": 0, "better": 0, "between": [0, 2], "beyond": 2, "bike": 0, "biker": 0, "bikeshar": 0, "both": 0, "boundari": 2, "brent": 2, "built": 2, "c": [0, 2], "can": [0, 2], "casual": 0, "cat": 0, "categor": 0, "chapman": 2, "chapter": 2, "choleski": 2, "choos": 2, "cleaner": 0, "clear": 0, "cnt": 0, "code": 0, "column": 0, "combin": 2, "compar": [1, 2], "comparison": 1, "complex": 2, "comput": [0, 2], "compute_df": 0, "concept": 2, "construct": [0, 2], "contain": 0, "continu": 2, "convert": 0, "correspond": 0, "count": 0, "crc": 2, "cross": 0, "cube": 2, "cv": [0, 2], "d": 0, "dai": 0, "daili": 0, "data": [1, 2], "dataset": 0, "default": [0, 2], "default_rng": 0, "degre": [0, 1], "demonstr": 0, "dens": 2, "deriv": 2, "detail": 2, "determin": 2, "dev": 0, "df": [0, 1], "diff": 0, "differ": 0, "dimension": 2, "directli": [0, 2], "discuss": 2, "document": [0, 2], "dot": 2, "dt": 2, "e": 2, "each": 0, "easier": 2, "edit": 2, "effect": 2, "effici": 2, "element": 2, "els": 0, "ensur": 2, "equival": 2, "everi": 2, "exact": 2, "exampl": 1, "execut": 0, "explicitli": 2, "exploit": 2, "expos": 2, "expr": 0, "ext": 2, "extend": 2, "extens": 0, "extrapol": 2, "extrem": 2, "f": [0, 2], "fair": 0, "fals": 0, "fast": 2, "faster": 2, "featur": [0, 2], "fewer": 2, "fig": 0, "figsiz": 0, "final": 0, "find": [0, 2], "finit": 2, "first": 0, "fit": [1, 2], "fit_gcv": 0, "fit_r": 0, "fit_r_syn": 0, "fitter": 0, "focu": 0, "formul": 1, "found": 2, "freedom": [0, 1], "friedman": 2, "from": [0, 2], "full": 2, "function": [0, 2], "g": 0, "gcv": [1, 2], "ge": 2, "gener": [0, 2], "get": 0, "goal": 2, "green": 2, "h_i": 2, "hall": 2, "handl": [0, 2], "hasti": 2, "hat": 2, "have": 0, "head": 0, "heta": 2, "heta_j": 2, "holidai": 0, "hour": 0, "hr": 0, "hr_numer": 0, "hum": 0, "i": [0, 2], "ident": [0, 2], "ij": 2, "iloc": 0, "im": 2, "implement": [0, 1], "impli": 0, "import": 0, "increas": 0, "infer": 2, "infinit": 2, "infti": 2, "initi": 0, "input": 2, "inspect": 0, "instead": 2, "int": 2, "integr": 2, "intern": 0, "interpol": 2, "intuit": 2, "ipython": 0, "islp": 0, "its": 2, "j": 2, "jan": 0, "jk": 2, "k": 2, "kei": 0, "knot": [1, 2], "label": 0, "lambda": [0, 2], "lamval": 2, "larg": 2, "learn": 2, "least": 2, "legend": 0, "len": 0, "length": 0, "let": 0, "librari": 0, "lightgrai": 0, "limit": 1, "line": 0, "linear": 2, "load": 1, "load_data": 0, "load_ext": 0, "log": 1, "log_bik": 0, "loop": 0, "loss": 2, "lq": 0, "lw": 0, "m": 0, "make": [0, 2], "match": 0, "math": 2, "mathbf": 2, "mathemat": 2, "matplotlib": 0, "matric": 2, "matrix": 1, "max": 0, "mean": 0, "measur": 2, "median": 0, "method": [0, 2], "microbenchmark": 0, "might": 0, "millisecond": 0, "min": 0, "min_": 2, "mine": 2, "minim": [0, 2], "mnth": 0, "model": [0, 2], "monoton": 2, "more": 2, "n": [1, 2], "n_": 2, "n_j": 2, "n_k": 2, "n_knot": [0, 2], "n_knots_r": 0, "n_knots_reduc": 0, "n_syn": 0, "natur": 0, "nearli": 0, "necessari": 0, "need": 0, "neg": 0, "neval": 0, "nk": [0, 2], "nknot": [0, 2], "non": 0, "nonparametr": 2, "normal": 0, "note": [0, 2], "notebook": 0, "now": 0, "np": 0, "number": 0, "numer": [0, 2], "numpi": 0, "o": [0, 2], "often": 0, "omega": 2, "omega_n": 2, "onc": 0, "optim": [0, 2], "order": 0, "origin": 0, "other": 2, "our": 2, "outlin": 2, "overfit": 2, "p": 2, "packag": 0, "panda": 0, "paramet": [0, 2], "pass": 2, "pd": 0, "penal": 2, "penalti": 2, "per": 0, "piecewis": 2, "place": 2, "plot": 0, "plt": 0, "point": 2, "polynomi": 2, "pred_r": 0, "predict": [0, 2], "primari": 2, "print": 0, "problem": 1, "properti": 2, "purpl": 0, "pyplot": 0, "python": 2, "q": 2, "r": 1, "random": 0, "rang": 2, "raw": 2, "reduc": [0, 2], "refer": 1, "regist": 0, "regress": 2, "relat": 2, "relationship": [0, 2], "remain": 2, "remark": 2, "renam": 0, "rental": 0, "repeat": 0, "repres": 0, "request": 2, "residu": 2, "restor": 2, "result": 0, "return": 0, "ridg": 2, "risk": 2, "rng": 0, "root": 2, "rough": 2, "rpy2": 0, "run": 0, "same": [0, 2], "scale": [0, 2], "scatter": 0, "score": 0, "season": 0, "second": 2, "select": 0, "set_titl": 0, "set_xlabel": 0, "set_ylabel": 0, "setup": 1, "should": 0, "show": 0, "silverman": 2, "similar": 0, "sin": 0, "sinc": [0, 2], "slightli": 0, "smaller": 2, "smoother": 2, "smoothing_splin": [1, 2], "solv": [0, 2], "solve_gcv": 0, "solver": 2, "sort": 0, "sorted_idx": 0, "spar": [0, 2], "spars": 2, "specif": 2, "specifi": [0, 2], "speed": [1, 2], "spl_log": 0, "spl_py": 0, "splinefitt": 0, "springer": 2, "sprintf": 0, "squar": 2, "stabil": 2, "standard": 0, "statist": 2, "std": 0, "structur": 2, "subplot": 0, "sum": 2, "sum_": 2, "support": [0, 2], "synthes": 2, "synthet": 1, "system": 2, "t": 2, "t_py": 0, "temp": 0, "than": 2, "thei": 0, "them": 0, "theoret": 2, "theori": 1, "thi": 0, "through": 2, "tibshirani": 2, "time": [0, 2], "timeit": 0, "to_numer": 0, "trace": 2, "transfer": 0, "transform": 1, "tridiagon": 2, "true": 0, "tune": [1, 2], "two": 2, "typic": 0, "uniform": 0, "uniqu": [0, 2], "unit": 0, "unsort": 0, "up": [0, 2], "uq": 0, "usag": 0, "util": 2, "valid": 0, "valu": [0, 2], "varianc": 0, "vector": 2, "verif": 0, "via": [0, 2], "visual": 0, "w": 2, "wai": 2, "want": 0, "washington": 0, "we": [0, 2], "weathersit": 0, "weekdai": 0, "weight": [0, 2], "well": [0, 2], "when": 0, "where": 2, "which": [0, 2], "while": 2, "why": 2, "windspe": 0, "without": 2, "workingdai": 0, "write": 2, "x": [0, 2], "x_1": 2, "x_i": 2, "x_n": 2, "x_plot": 0, "x_scale_": 0, "x_syn": 0, "x_val": 0, "y": [0, 2], "y_i": 2, "y_py": 0, "y_r": 0, "y_syn": 0, "yet": 2, "yield": 2, "zero": 2, "\u03bc": 0}, "titles": ["Comparing <code class=\"docutils literal notranslate\"><span class=\"pre\">smoothing_spline</span></code> with R\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">smooth.spline</span></code>", "Smoothing Spline Documentation", "Smoothing Splines: Theory and Implementation"], "titleterms": {"": [0, 2], "1": [0, 2], "2": [0, 2], "3": 2, "4": 2, "5": 2, "500": 0, "A": 2, "In": 0, "The": 2, "anoth": 0, "automat": 0, "b": 2, "basi": 2, "compar": 0, "comparison": [0, 2], "content": 1, "cubic": 2, "data": 0, "degre": 2, "df": 2, "differ": 2, "document": 1, "exampl": 0, "fit": 0, "form": 2, "formul": 2, "freedom": 2, "gcv": 0, "implement": 2, "kei": 2, "knot": 0, "limit": 0, "load": 0, "log": 0, "matrix": 2, "n": 0, "natur": 2, "packag": 2, "problem": 2, "python": 0, "r": [0, 2], "refer": 2, "reinsch": 2, "setup": 0, "smooth": [0, 1, 2], "smoothing_splin": 0, "solut": 2, "speed": 0, "spline": [0, 1, 2], "synthet": 0, "theori": 2, "thi": 2, "transform": 0, "tune": 0, "us": [0, 2], "v": 2}})