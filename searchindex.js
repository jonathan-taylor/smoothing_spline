Search.setIndex({"alltitles": {"1. All Unique X as Knots": [[1, "1.-All-Unique-X-as-Knots"]], "1. The Smoothing Spline Problem": [[4, "the-smoothing-spline-problem"]], "1. Using smoothing_spline (Python)": [[0, "1.-Using-smoothing_spline-(Python)"]], "2. Fixed Number of Knots (K=200)": [[1, "2.-Fixed-Number-of-Knots-(K=200)"]], "2. Matrix Formulation": [[4, "matrix-formulation"]], "2. Using smooth.spline (R)": [[0, "2.-Using-smooth.spline-(R)"]], "3. Degrees of Freedom ($df$)": [[4, "degrees-of-freedom-df"]], "4. Comparison with R\u2019s smooth.spline": [[4, "comparison-with-r-s-smooth-spline"]], "5. References": [[4, "references"]], "A. The Basis Form (Used in this Package)": [[4, "a-the-basis-form-used-in-this-package"]], "Analysis": [[2, "Analysis"]], "Another Example: Log-Transformation": [[0, "Another-Example:-Log-Transformation"]], "Automatic Tuning with GCV": [[0, "Automatic-Tuning-with-GCV"]], "B. The Reinsch Form (Used in R\u2019s smooth.spline)": [[4, "b-the-reinsch-form-used-in-r-s-smooth-spline"]], "Boundary Behavior Comparison: smoothing_spline vs scipy": [[2, null]], "Comparing smoothing_spline with R\u2019s smooth.spline": [[0, null]], "Comparison": [[0, "Comparison"]], "Conclusion": [[1, "Conclusion"]], "Contents:": [[3, null]], "Fitting Smoothing Splines": [[0, "Fitting-Smoothing-Splines"]], "Fitting the Models": [[2, "Fitting-the-Models"]], "GCV Solve Performance": [[1, "GCV-Solve-Performance"]], "In Python (smoothing_spline)": [[0, "In-Python-(smoothing_spline)"]], "In R": [[0, "In-R"]], "Key Differences": [[4, "key-differences"]], "Limited knots": [[0, "Limited-knots"]], "Loading the Data": [[0, "Loading-the-Data"]], "Performance Comparison: Pure Python vs C++ Extension": [[1, null]], "Performance Note": [[0, "Performance-Note"]], "Reinsch Form vs. Basis Form": [[4, "reinsch-form-vs-basis-form"]], "Results Visualization": [[1, "Results-Visualization"]], "Setup": [[0, "Setup"], [1, "Setup"], [2, "Setup"]], "Smoothing Spline Documentation": [[3, null]], "Smoothing Splines: Theory and Implementation": [[4, null]], "Speed Comparison": [[0, "Speed-Comparison"]], "Speed Comparison at Different Scales": [[1, "Speed-Comparison-at-Different-Scales"]], "Synthetic Speed Comparison (N=500)": [[0, "Synthetic-Speed-Comparison-(N=500)"]], "The Solution: Natural Cubic Spline": [[4, "the-solution-natural-cubic-spline"]], "Visualization": [[2, "Visualization"]]}, "docnames": ["compare_R", "compare_cpp", "compare_scipy", "index", "theory"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1}, "filenames": ["compare_R.ipynb", "compare_cpp.ipynb", "compare_scipy.ipynb", "index.md", "theory.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 2, 3], "0": [0, 1, 2, 4], "000": 4, "003491": 0, "05": 0, "09998": 0, "0x0002": 0, "1": [2, 3], "10": [0, 1, 2, 4], "100": [0, 1], "1000": 1, "10000": [0, 1], "1013": 0, "1020": 0, "104": 0, "1052": 0, "1079": 0, "11": 0, "12": 0, "13": [0, 1], "1329": 0, "155": 0, "16": [0, 1], "17": 1, "18": 1, "183": 0, "18x": 1, "19": 1, "1994": 4, "1e": 2, "2": [2, 3], "20": 1, "200": [0, 2], "2000": 1, "20000": 1, "2009": 4, "21": 1, "22": [0, 1], "23": 0, "24": 0, "244": 0, "258": 0, "27": 0, "2727": 0, "28": 0, "2879": 0, "2f": [0, 1], "2nd": 4, "3": [0, 1, 2, 3], "30": [0, 2], "30x": 1, "32": 0, "34": [0, 1], "356": 0, "37x": 1, "39": [0, 1], "3efc": 0, "4": [0, 1, 3], "40": 0, "41": 1, "42": [1, 2], "43": 1, "44": 1, "45x": 1, "46": 1, "49": 0, "4d": 1, "4e": 1, "4f": 1, "5": [0, 2, 3], "50": [0, 2], "500": [1, 3], "5000": 1, "50000": 1, "504108e": 0, "589": 0, "5d": 1, "6": [0, 1, 2], "694": 0, "6f": 0, "7": [0, 1], "75": 0, "8": 0, "80": 0, "81": 0, "845": 1, "846": 1, "847": 1, "8726": 0, "9": [0, 1], "91": 0, "931d26646de6": 0, "941": 0, "9772068125418998e": 0, "98x": 1, "99997440744539": 0, "A": 0, "As": 2, "For": [0, 2, 4], "If": 4, "In": [1, 2, 4], "It": 4, "NOT": 1, "Not": 4, "One": 0, "The": [0, 1, 2, 3], "There": 4, "To": 0, "_": 4, "__init__": 1, "__post_init__": 1, "_basesplinefitt": 1, "_brentq": 1, "_cpp_fitter": 0, "_ext": 1, "_find_lamval_for_df": 1, "_prepare_matric": 1, "_rinterface_cffi_api": 0, "_spline_extens": 1, "_wrap_nan_rais": 1, "_zero": 1, "_zeros_pi": 1, "ab": 0, "abi": 0, "abi3": 0, "about": 0, "abov": 1, "absolut": 0, "abstract": 4, "access": 0, "accur": 0, "add": 0, "addit": 0, "algorithm": [0, 1, 4], "all": [0, 4], "allow": 4, "alpha": [0, 2], "alreadi": 0, "also": [0, 4], "an": [1, 4], "anoth": 3, "api": 0, "append": 1, "approach": 4, "ar": [0, 2, 4], "arg": 1, "argsort": 0, "arm64": 0, "around": 0, "ask": 2, "atemp": 0, "automat": [1, 3, 4], "avail": [0, 1], "avoid": [0, 2], "awai": 2, "ax": [0, 1, 2], "axvlin": 2, "b": [0, 1, 2], "b96a8100": 0, "back": 0, "backend": 4, "background": 4, "band": [0, 4], "base": [1, 2], "basi": 0, "becaus": [0, 4], "becom": [2, 4], "behavior": 0, "benchmark": 1, "benchmark_fitt": 1, "best": 1, "best_df": 0, "best_lam": [0, 1], "best_lam_sc": 0, "better": 0, "between": [0, 2, 4], "beyond": [2, 4], "bike": 0, "biker": 0, "bikeshar": 0, "black": 2, "blue": 2, "both": [0, 2], "bound": 1, "boundari": 4, "brent": 4, "brentq": 1, "built": 4, "c": [0, 4], "calcul": [0, 2], "call": 1, "can": [0, 4], "case": 1, "casual": 0, "cat": 0, "categor": 0, "caus": 1, "cdot": 0, "cell": 1, "chapman": 4, "chapter": 4, "check": 1, "choleski": 4, "choos": 4, "cleaner": 0, "clear": 0, "cnt": 0, "code": 0, "coeffici": 2, "color": 2, "column": 0, "combin": 4, "compar": [1, 3, 4], "comparison": 3, "complex": [0, 1, 4], "comput": [0, 1, 4], "compute_df": 0, "concept": 4, "condit": 2, "constrain": 2, "construct": [0, 4], "contain": 0, "context": 2, "continu": 4, "convert": 0, "correspond": 0, "cost": 0, "could": 1, "count": 0, "cpp": 1, "cpp_avail": 1, "cpp_fitter": 1, "cpp_gcv_time": 1, "crc": 4, "cross": 0, "cryptex": 0, "cube": 4, "cubic": 2, "current": 0, "curv": 2, "curvatur": 2, "cv": [0, 4], "d": 0, "dai": 0, "daili": 0, "dash": 2, "data": [2, 3, 4], "dataset": [0, 2], "def": 1, "default": [0, 4], "default_rng": [0, 1, 2], "defin": 2, "degre": [0, 2, 3], "demonstr": [0, 2], "dens": 4, "deriv": [2, 4], "design": 2, "detail": 4, "determin": 4, "dev": 0, "df": [0, 1, 3], "df_error_func": 1, "diff": 0, "differ": [0, 2], "dimension": 4, "direct": 1, "directli": [0, 4], "discuss": 4, "disp": 1, "dlopen": 0, "document": [0, 1, 2, 4], "doe": 2, "dot": 4, "dt": [2, 4], "due": 1, "dure": 2, "dylib": 0, "e": [1, 2, 4], "each": 0, "easier": 4, "edf": 0, "edit": 4, "effect": 4, "effici": [1, 4], "eigen": 1, "element": 4, "elif": 1, "els": [0, 1], "end": 2, "enforc": 2, "ensur": [2, 4], "equival": 4, "error": 0, "especi": 1, "essenti": 2, "estim": 0, "everi": 4, "exact": [0, 4], "exampl": 3, "except": 1, "execut": 0, "exhibit": 2, "explicitli": [2, 4], "exploit": 4, "expos": 4, "expr": 0, "ext": 4, "extend": 4, "extens": 0, "extrapol": [2, 4], "extrem": 4, "f": [0, 1, 4], "fa7a": 0, "fair": [0, 2], "fals": [0, 1], "fast": 4, "faster": 4, "feasibl": 1, "featur": [0, 2, 4], "fewer": 4, "fig": [0, 1, 2], "figsiz": [0, 1, 2], "file": [0, 1], "final": 0, "find": [0, 1, 2, 4], "finit": 4, "first": [0, 2], "fit": [1, 3, 4], "fit_gcv": 0, "fit_r": 0, "fit_r_syn": 0, "fitter": [0, 1, 2], "fitter_cpp": 1, "fitter_pi": 1, "fix": 2, "focu": 0, "follow": 1, "form": 2, "formul": 3, "found": 4, "framework": 0, "freedom": [0, 2, 3], "friedman": 4, "from": [0, 1, 2, 4], "full": 4, "full_output": 1, "function": [0, 2, 4], "g": [0, 2], "gcv": [2, 3, 4], "ge": 4, "gener": [0, 2, 4], "get": [0, 2], "git": [0, 1], "given": 1, "goal": 4, "good": 2, "grai": 2, "green": 4, "grid": [1, 2], "gt": [0, 1], "guarante": 2, "h_i": 4, "hall": 4, "handl": [0, 4], "hasti": 4, "hat": 4, "have": [0, 1], "head": 0, "here": 2, "heta": 4, "heta_j": 4, "heurist": 2, "highli": 1, "highlight": 2, "holidai": 0, "hour": 0, "howev": 1, "hr": 0, "hr_numer": 0, "hum": 0, "hutchinson": 0, "i": [0, 1, 2, 4], "ident": [0, 4], "ij": 4, "illustr": 2, "iloc": 0, "im": 4, "implement": [0, 1, 2, 3], "impli": [0, 2], "import": [0, 1, 2], "importerror": [0, 1], "increas": [0, 1], "infer": 4, "infinit": 4, "infti": 4, "initi": 0, "input": 4, "inspect": 0, "instead": 4, "int": [2, 4], "integ": 0, "integr": 4, "intern": [0, 2], "interpol": [2, 4], "intuit": 4, "invers": 0, "involv": [0, 1], "ipython": 0, "islp": [0, 1], "its": 4, "j": 4, "jan": 0, "jk": 4, "jonathantaylor": 0, "just": 2, "k": [0, 4], "kei": [0, 2], "knot": [2, 3, 4], "label": [0, 1, 2], "lam": 2, "lam_best": 2, "lam_scipi": 2, "lambda": [0, 1, 2, 4], "lamval": [1, 4], "larg": [0, 1, 4], "last": 1, "learn": 4, "least": 4, "legend": [0, 1, 2], "len": 0, "length": 0, "less": 0, "let": [0, 2], "lib": [0, 1], "librari": [0, 1], "librbla": 0, "lightgrai": 0, "like": 0, "limit": [1, 3], "line": [0, 1, 2], "linear": [2, 4], "linestyl": 2, "linewidth": 2, "linspac": 2, "ll": [1, 2], "load": 3, "load_data": 0, "load_ext": 0, "log": 3, "log10_lam_bound": 1, "log_bik": 0, "log_lam_scaled_opt": 1, "look": 2, "loop": 0, "loss": 4, "lq": 0, "lt": [0, 1], "lw": 0, "m": 0, "maintain": 2, "make": [0, 4], "make_smoothing_splin": 2, "mani": 2, "match": [0, 2], "math": 4, "mathbf": 4, "mathemat": 4, "matplotlib": [0, 1, 2], "matric": [0, 4], "matrix": [0, 1, 3], "max": [0, 2], "maxit": 1, "mean": 0, "measur": [1, 4], "median": 0, "messag": 0, "method": [0, 1, 2, 4], "microbenchmark": 0, "microsecond": 0, "might": [0, 2], "min": [0, 2], "min_": 4, "mine": 4, "minim": [0, 2, 4], "mitig": 0, "mnth": 0, "mode": 0, "model": [0, 4], "monoton": 4, "more": 4, "most": 1, "multipl": 1, "must": 1, "n": [1, 2, 3, 4], "n_": 4, "n_j": 4, "n_k": 4, "n_knot": [0, 1, 4], "n_knots_r": 0, "n_knots_reduc": 0, "n_syn": 0, "nan": 1, "nanosecond": 0, "natur": [0, 2], "nearli": 0, "necessari": 0, "necessarili": 2, "need": 0, "neg": 0, "neval": 0, "nk": [0, 4], "nknot": [0, 4], "non": 0, "none": 1, "nonparametr": 4, "normal": [0, 1, 2], "note": [2, 3, 4], "notebook": 0, "now": [0, 2], "np": [0, 1, 2], "ns_larg": 1, "number": 0, "numer": [0, 4], "numpi": [0, 1, 2], "o": [0, 1, 4], "object": 2, "observ": [1, 2], "offer": 0, "often": [0, 1, 2], "omega": 4, "omega_n": 4, "onc": 0, "one": 2, "oper": [0, 1], "optim": [0, 1, 4], "order": 0, "origin": 0, "oscil": 2, "other": 4, "our": [0, 2, 4], "outlin": 4, "outsid": 2, "over": 0, "overfit": 4, "overflow": 0, "p": [1, 4], "packag": [0, 1, 2], "panda": 0, "paramet": [0, 4], "parameter": 2, "pass": 4, "path": 1, "pd": 0, "penal": 4, "penalti": 4, "pentadiagon": 0, "per": 0, "perfectli": 2, "perform": 3, "pick": 2, "piecewis": 4, "place": 4, "plot": [0, 1, 2], "plt": [0, 1, 2], "point": 4, "polynomi": [2, 4], "potenti": 0, "practic": 1, "preboot": 0, "pred_r": 0, "predict": [0, 2, 4], "prefer": 2, "primari": 4, "print": [0, 1], "problem": 3, "properti": [2, 4], "provid": [1, 2], "pure": 0, "purpl": 0, "py": 1, "pyplot": [0, 1, 2], "python": 4, "python3": [0, 1], "q": 4, "qualit": 2, "r": [1, 2, 3], "rais": 1, "random": [0, 1, 2], "rang": [2, 4], "raw": 4, "reason": [0, 2], "recent": 1, "red": 2, "reduc": [0, 4], "refer": 3, "referenc": 0, "regist": 0, "regress": 4, "regular": 2, "relat": [2, 4], "relationship": [0, 4], "remain": 4, "remark": 4, "renam": 0, "rental": 0, "repeat": 0, "repo": [0, 1], "repres": 0, "request": 4, "residu": 4, "resourc": 0, "restor": 4, "result": [0, 2], "results_all_knot": 1, "results_c": 1, "results_fixed_knot": 1, "return": [0, 1, 2], "ridg": 4, "risk": 4, "rng": [0, 1, 2], "root": [1, 4], "rough": 4, "roughli": 2, "rpy2": 0, "rtol": 1, "run": 0, "runtimeerror": 1, "safe": 2, "sai": 2, "same": [0, 2, 4], "scale": [0, 2, 4], "scatter": [0, 2], "scipi": 1, "score": 0, "season": 0, "second": [1, 2, 4], "seen": 2, "segment": 2, "select": 0, "self": 1, "set_titl": [0, 1, 2], "set_xlabel": [0, 1], "set_ylabel": [0, 1], "set_ylim": 2, "setup": 3, "should": [0, 2], "show": [0, 1, 2], "sign": 1, "signific": [0, 1], "silverman": 4, "similar": [0, 2], "simplic": 2, "sin": [0, 1, 2], "sinc": [0, 4], "site": [0, 1], "size": 1, "slightli": [0, 2], "slower": 0, "small": 1, "smaller": 4, "smooth": [1, 2], "smoother": 4, "smoothing_splin": [1, 3, 4], "so": 0, "solv": [0, 2, 4], "solve_gcv": [0, 1, 2], "solver": 4, "sort": [0, 1, 2], "sorted_idx": 0, "spar": [0, 4], "spars": 4, "special": 0, "specif": [0, 2, 4], "specifi": [0, 4], "speed": [3, 4], "speedup": [0, 1], "speedup_fix": 1, "spl_log": 0, "spl_py": 0, "spl_scipi": 2, "spline": [1, 2], "splinefitt": [0, 1, 2], "splinefittercpp": 1, "springer": 4, "sprintf": 0, "squar": 4, "stabil": 4, "standard": 0, "start": 1, "statist": [2, 4], "std": 0, "strength": 2, "string": 1, "structur": 4, "subplot": [0, 1, 2], "sum": [2, 4], "sum_": 4, "support": [0, 4], "synthes": 4, "synthet": [2, 3], "system": [0, 4], "t": [2, 4], "t_py": 0, "taken": 1, "target_df": 1, "temp": 0, "test": 1, "than": [0, 4], "thei": 0, "them": [0, 2], "theoret": 4, "theori": 3, "thi": [0, 1, 2], "through": 4, "tibshirani": 4, "time": [0, 1, 4], "timeit": 0, "to_numer": 0, "todo": 0, "trace": [0, 4], "traceback": 1, "train": 2, "transfer": 0, "transform": 3, "tri": 0, "tridiagon": 4, "true": [0, 1, 2], "try": [0, 1, 2], "tune": [1, 3, 4], "two": 4, "typic": 0, "uniform": [0, 1, 2], "uniqu": [0, 4], "unit": 0, "unless": 2, "unsort": 0, "up": [0, 4], "uq": 0, "us": [1, 2], "usag": 0, "user": 0, "usual": 2, "util": 4, "valid": 0, "valu": [0, 1, 2, 4], "valueerror": 1, "varianc": 0, "vector": [0, 4], "venv": [0, 1], "verif": 0, "version": 0, "vertic": 2, "via": [0, 4], "visual": 0, "volum": 0, "w": [1, 4], "w_i": 2, "wa": 1, "wai": 4, "want": 0, "warn": 0, "washington": 0, "we": [0, 1, 2, 4], "weathersit": 0, "weekdai": 0, "weight": [0, 4], "well": [0, 4], "when": [0, 1], "where": [0, 1, 4], "wherea": 0, "which": [0, 2, 4], "while": [0, 2, 4], "why": 4, "wild": 2, "windspe": 0, "within": 2, "without": 4, "workingdai": 0, "would": 2, "write": 4, "x": [0, 2, 4], "x_1": 4, "x_i": [2, 4], "x_n": 4, "x_plot": [0, 2], "x_rang": 2, "x_scale_": [0, 1], "x_syn": 0, "x_val": 0, "xtol": 1, "y": [0, 1, 2, 4], "y_i": [2, 4], "y_our": 2, "y_py": 0, "y_r": 0, "y_scipi": 2, "y_syn": 0, "yet": 4, "yield": 4, "zero": [2, 4], "zip": 1, "zorder": 2, "\u03bc": 0}, "titles": ["Comparing <code class=\"docutils literal notranslate\"><span class=\"pre\">smoothing_spline</span></code> with R\u2019s <code class=\"docutils literal notranslate\"><span class=\"pre\">smooth.spline</span></code>", "Performance Comparison: Pure Python vs C++ Extension", "Boundary Behavior Comparison: <code class=\"docutils literal notranslate\"><span class=\"pre\">smoothing_spline</span></code> vs <code class=\"docutils literal notranslate\"><span class=\"pre\">scipy</span></code>", "Smoothing Spline Documentation", "Smoothing Splines: Theory and Implementation"], "titleterms": {"": [0, 4], "1": [0, 1, 4], "2": [0, 1, 4], "200": 1, "3": 4, "4": 4, "5": 4, "500": 0, "A": 4, "In": 0, "The": 4, "all": 1, "analysi": 2, "anoth": 0, "automat": 0, "b": 4, "basi": 4, "behavior": 2, "boundari": 2, "c": 1, "compar": 0, "comparison": [0, 1, 2, 4], "conclus": 1, "content": 3, "cubic": 4, "data": 0, "degre": 4, "df": 4, "differ": [1, 4], "document": 3, "exampl": 0, "extens": 1, "fit": [0, 2], "fix": 1, "form": 4, "formul": 4, "freedom": 4, "gcv": [0, 1], "implement": 4, "k": 1, "kei": 4, "knot": [0, 1], "limit": 0, "load": 0, "log": 0, "matrix": 4, "model": 2, "n": 0, "natur": 4, "note": 0, "number": 1, "packag": 4, "perform": [0, 1], "problem": 4, "pure": 1, "python": [0, 1], "r": [0, 4], "refer": 4, "reinsch": 4, "result": 1, "scale": 1, "scipi": 2, "setup": [0, 1, 2], "smooth": [0, 3, 4], "smoothing_splin": [0, 2], "solut": 4, "solv": 1, "speed": [0, 1], "spline": [0, 3, 4], "synthet": 0, "theori": 4, "thi": 4, "transform": 0, "tune": 0, "uniqu": 1, "us": [0, 4], "v": [1, 2, 4], "visual": [1, 2], "x": 1}})