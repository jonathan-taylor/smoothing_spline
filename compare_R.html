<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Comparing smoothing_spline with R’s smooth.spline &#8212; smoothing_spline  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Smoothing Splines: Theory and Implementation" href="theory.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Comparing-smoothing_spline-with-R's-smooth.spline">
<h1>Comparing <code class="docutils literal notranslate"><span class="pre">smoothing_spline</span></code> with R’s <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code><a class="headerlink" href="#Comparing-smoothing_spline-with-R's-smooth.spline" title="Link to this heading">¶</a></h1>
<p>This document demonstrates the usage of the <code class="docutils literal notranslate"><span class="pre">smoothing_spline</span></code> package and compares it with the standard <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code> function in R. We will use the <code class="docutils literal notranslate"><span class="pre">Bikeshare</span></code> dataset from the <code class="docutils literal notranslate"><span class="pre">ISLP</span></code> package.</p>
<section id="Setup">
<h2>Setup<a class="headerlink" href="#Setup" title="Link to this heading">¶</a></h2>
<p>First, we need to import the necessary libraries and load the <code class="docutils literal notranslate"><span class="pre">rpy2</span></code> extension to run R code directly in this notebook.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ISLP</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">smoothing_spline</span><span class="w"> </span><span class="kn">import</span> <span class="n">SplineFitter</span>

<span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
</pre></div>
</div>
</div>
</section>
<section id="Loading-the-Data">
<h2>Loading the Data<a class="headerlink" href="#Loading-the-Data" title="Link to this heading">¶</a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">Bikeshare</span></code> dataset, which contains daily counts of bike rentals in Washington D.C.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Bike</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;Bikeshare&#39;</span><span class="p">)</span>
<span class="n">Bike</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>season</th>
      <th>mnth</th>
      <th>day</th>
      <th>hr</th>
      <th>holiday</th>
      <th>weekday</th>
      <th>workingday</th>
      <th>weathersit</th>
      <th>temp</th>
      <th>atemp</th>
      <th>hum</th>
      <th>windspeed</th>
      <th>casual</th>
      <th>registered</th>
      <th>bikers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Jan</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>clear</td>
      <td>0.24</td>
      <td>0.2879</td>
      <td>0.81</td>
      <td>0.0</td>
      <td>3</td>
      <td>13</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Jan</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>clear</td>
      <td>0.22</td>
      <td>0.2727</td>
      <td>0.80</td>
      <td>0.0</td>
      <td>8</td>
      <td>32</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Jan</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>clear</td>
      <td>0.22</td>
      <td>0.2727</td>
      <td>0.80</td>
      <td>0.0</td>
      <td>5</td>
      <td>27</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Jan</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>clear</td>
      <td>0.24</td>
      <td>0.2879</td>
      <td>0.75</td>
      <td>0.0</td>
      <td>3</td>
      <td>10</td>
      <td>13</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Jan</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>clear</td>
      <td>0.24</td>
      <td>0.2879</td>
      <td>0.75</td>
      <td>0.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We will focus on the relationship between the hour of the day (<code class="docutils literal notranslate"><span class="pre">hr</span></code>) and the number of bikers (<code class="docutils literal notranslate"><span class="pre">bikers</span></code>). Since <code class="docutils literal notranslate"><span class="pre">hr</span></code> is categorical in the original dataset but represents time, we convert it to numeric.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="mi">7</span>
<span class="c1"># &#39;bikers&#39; is &#39;cnt&#39; in the original dataset, ISLP might have renamed it or we use &#39;cnt&#39;</span>
<span class="k">if</span> <span class="s1">&#39;bikers&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Bike</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">Bike</span><span class="p">[</span><span class="s1">&#39;bikers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bike</span><span class="p">[</span><span class="s1">&#39;cnt&#39;</span><span class="p">]</span>

<span class="n">hr_numeric</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">Bike</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">])</span>
<span class="n">bikers</span> <span class="o">=</span> <span class="n">Bike</span><span class="p">[</span><span class="s1">&#39;bikers&#39;</span><span class="p">]</span>

<span class="c1"># Sort by hour for cleaner plotting lines</span>
<span class="n">sorted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">)</span>
<span class="n">x_plot</span> <span class="o">=</span> <span class="n">hr_numeric</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sorted_idx</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Fitting-Smoothing-Splines">
<h2>Fitting Smoothing Splines<a class="headerlink" href="#Fitting-Smoothing-Splines" title="Link to this heading">¶</a></h2>
<section id="1.-Using-smoothing_spline-(Python)">
<h3>1. Using <code class="docutils literal notranslate"><span class="pre">smoothing_spline</span></code> (Python)<a class="headerlink" href="#1.-Using-smoothing_spline-(Python)" title="Link to this heading">¶</a></h3>
<p>We fit a smoothing spline with a specified degrees of freedom (<span class="math notranslate nohighlight">\(df=5\)</span>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit model</span>
<span class="n">spl_py</span> <span class="o">=</span> <span class="n">SplineFitter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">hr_numeric</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">spl_py</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">bikers</span><span class="p">)</span>

<span class="c1"># Predict</span>
<span class="n">y_py</span> <span class="o">=</span> <span class="n">spl_py</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Using-smooth.spline-(R)">
<h3>2. Using <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code> (R)<a class="headerlink" href="#2.-Using-smooth.spline-(R)" title="Link to this heading">¶</a></h3>
<p>We fit the same model using R. We transfer the data to R and run the <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code> function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">hr_numeric</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">bikers</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">y_r</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">df</span>
<span class="c1"># Fit model in R</span>
<span class="n">fit_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">,</span><span class="w"> </span><span class="n">bikers</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Predict at unique hours</span>
<span class="c1"># unique() in R returns unsorted, but we want to match x_plot order</span>
<span class="n">x_vals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">))</span>
<span class="n">pred_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">fit_r</span><span class="p">,</span><span class="w"> </span><span class="n">x_vals</span><span class="p">)</span>
<span class="n">y_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pred_r</span><span class="o">$</span><span class="n">y</span>
</pre></div>
</div>
</div>
</section>
<section id="Comparison">
<h3>Comparison<a class="headerlink" href="#Comparison" title="Link to this heading">¶</a></h3>
<p>Let’s visualize the results. They should be nearly identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hr_numeric</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">)),</span> <span class="n">bikers</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_py</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Python (smoothing_spline)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">y_r</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R (smooth.spline)&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Hour&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Number of Bikers&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Comparison of Smoothing Splines (df=</span><span class="si">{df}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Numerical comparison</span>
<span class="c1"># Note: R might handle repeated x values slightly differently (using weights)</span>
<span class="c1"># smoothing_spline handles them naturally in the basis construction.</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_py</span> <span class="o">-</span> <span class="n">y_r</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Absolute Difference: </span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/compare_R_11_0.png" src="_images/compare_R_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean Absolute Difference: 0.003490
</pre></div></div>
</div>
</section>
</section>
<section id="Speed-Comparison">
<h2>Speed Comparison<a class="headerlink" href="#Speed-Comparison" title="Link to this heading">¶</a></h2>
<p>We will compare the execution time for fitting the model.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python Timing</span>
<span class="n">t_py</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -o -n 10 -r 3 SplineFitter(x=hr_numeric, df=10).fit(bikers)

<span class="c1"># R Timing</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5.86 ms ± 40.8 μs per loop (mean ± std. dev. of 3 runs, 10 loops each)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">hr_numeric</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">bikers</span>
<span class="nf">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
<span class="c1"># R Timing</span>
<span class="nf">microbenchmark</span><span class="p">(</span>
<span class="w">  </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">,</span><span class="w"> </span><span class="n">bikers</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">),</span>
<span class="w">  </span><span class="n">times</span><span class="o">=</span><span class="m">10</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Unit: milliseconds
                                       expr      min       lq     mean   median
 smooth.spline(hr_numeric, bikers, df = 10) 1.533482 1.947054 2.034625 2.156225
       uq      max neval
 2.171403 2.197301    10
</pre></div></div>
</div>
</section>
<section id="Automatic-Tuning-with-GCV">
<h2>Automatic Tuning with GCV<a class="headerlink" href="#Automatic-Tuning-with-GCV" title="Link to this heading">¶</a></h2>
<p>One of the key features of smoothing splines is the automatic selection of the smoothing parameter (<span class="math notranslate nohighlight">\(\lambda\)</span>) using Generalized Cross-Validation (GCV).</p>
<section id="In-R">
<h3>In R<a class="headerlink" href="#In-R" title="Link to this heading">¶</a></h3>
<p>R’s <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code> uses GCV (or CV) by default if <code class="docutils literal notranslate"><span class="pre">df</span></code> and <code class="docutils literal notranslate"><span class="pre">spar</span></code> are not specified.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span>
<span class="n">fit_gcv</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">,</span><span class="w"> </span><span class="n">bikers</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="c1"># cv=FALSE implies GCV</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Selected df (R):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fit_gcv</span><span class="o">$</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span>
<span class="s">&quot;</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="s">&quot;Selected lambda (R):&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fit_gcv</span><span class="o">$</span><span class="n">lambda</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;</span>
<span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Selected df (R): 23.09998
Selected lambda (R): 9.504108e-05
</pre></div></div>
</div>
</section>
<section id="In-Python-(smoothing_spline)">
<h3>In Python (smoothing_spline)<a class="headerlink" href="#In-Python-(smoothing_spline)" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">smoothing_spline</span></code> package also supports finding <span class="math notranslate nohighlight">\(\lambda\)</span> that minimizes the GCV score via the <code class="docutils literal notranslate"><span class="pre">solve_gcv</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize fitter with data</span>
<span class="c1"># Note: We use the internal C++ fitter for speed if available</span>
<span class="n">fitter</span> <span class="o">=</span> <span class="n">SplineFitter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">hr_numeric</span><span class="p">,</span> <span class="n">knots</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">))</span>

<span class="c1"># Solve for GCV</span>
<span class="n">best_lam</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">solve_gcv</span><span class="p">(</span><span class="n">bikers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected lambda (Python): </span><span class="si">{</span><span class="n">best_lam</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Get corresponding df</span>
<span class="c1"># We can access the internal fitter to compute DF for verification</span>
<span class="k">if</span> <span class="n">fitter</span><span class="o">.</span><span class="n">_cpp_fitter</span><span class="p">:</span>
    <span class="n">best_lam_scaled</span> <span class="o">=</span> <span class="n">best_lam</span> <span class="o">/</span> <span class="n">fitter</span><span class="o">.</span><span class="n">x_scale_</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">best_df</span> <span class="o">=</span> <span class="n">fitter</span><span class="o">.</span><span class="n">_cpp_fitter</span><span class="o">.</span><span class="n">compute_df</span><span class="p">(</span><span class="n">best_lam_scaled</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected df (Python): </span><span class="si">{</span><span class="n">best_df</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">best_df</span> <span class="o">=</span> <span class="s2">&quot;N/A (C++ extension not available)&quot;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Selected lambda (Python): 1.1524167755954249
Selected df (Python): 23.10044204963742
</pre></div></div>
</div>
<p>We can now visualize the optimal fit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hr_numeric</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">)),</span> <span class="n">bikers</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="c1"># fitter is already fitted with best_lam by solve_gcv</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">fitter</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_plot</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Optimal GCV (df=</span><span class="si">{</span><span class="n">best_df</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Hour&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Number of Bikers&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/compare_R_20_0.png" src="_images/compare_R_20_0.png" />
</div>
</div>
</section>
</section>
<section id="Another-Example:-Log-Transformation">
<h2>Another Example: Log-Transformation<a class="headerlink" href="#Another-Example:-Log-Transformation" title="Link to this heading">¶</a></h2>
<p>The relationship between hours and bikers might be better modeled on a log scale, as counts are non-negative and variance often increases with the mean.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit model on log(bikers)</span>
<span class="n">log_bikers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">bikers</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># Add 1 to avoid log(0)</span>
<span class="n">spl_log</span> <span class="o">=</span> <span class="n">SplineFitter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">hr_numeric</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">spl_log</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">log_bikers</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hr_numeric</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hr_numeric</span><span class="p">)),</span> <span class="n">log_bikers</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span> <span class="n">spl_log</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_plot</span><span class="p">),</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Log-Smoothing Spline (df=</span><span class="si">{df}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Hour&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Log(Number of Bikers + 1)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/compare_R_22_0.png" src="_images/compare_R_22_0.png" />
</div>
</div>
</section>
<section id="Synthetic-Speed-Comparison-(N=500)">
<h2>Synthetic Speed Comparison (N=500)<a class="headerlink" href="#Synthetic-Speed-Comparison-(N=500)" title="Link to this heading">¶</a></h2>
<p>Finally, we compare the speed of both implementations on a synthetic dataset with 500 unique <span class="math notranslate nohighlight">\(x\)</span> values.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Synthetic data</span>
<span class="n">n_syn</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x_syn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_syn</span><span class="p">))</span>
<span class="n">y_syn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_syn</span><span class="p">)</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_syn</span><span class="p">)</span>

<span class="c1"># Python Timing (using all unique x as knots)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python Timing (n=</span><span class="si">{</span><span class="n">n_syn</span><span class="si">}</span><span class="s2">, all knots):&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> SplineFitter(x=x_syn, df=10).fit(y_syn)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Python Timing (n=500, all knots):
743 ms ± 9.63 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">x_syn</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">y_syn</span>
<span class="nf">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;R Timing (n=%d):\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x_syn</span><span class="p">)))</span>

<span class="c1"># Fit once to inspect knots</span>
<span class="n">fit_r_syn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">x_syn</span><span class="p">,</span><span class="w"> </span><span class="n">y_syn</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">all.knots</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">n_knots_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_r_syn</span><span class="o">$</span><span class="n">fit</span><span class="o">$</span><span class="n">nk</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Number of knots used by R: %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_knots_r</span><span class="p">))</span>

<span class="nf">microbenchmark</span><span class="p">(</span>
<span class="w">  </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">x_syn</span><span class="p">,</span><span class="w"> </span><span class="n">y_syn</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">),</span>
<span class="w">  </span><span class="n">times</span><span class="o">=</span><span class="m">100</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
R Timing (n=500):
Number of knots used by R: 502
Unit: milliseconds
                                 expr      min       lq    mean   median
 smooth.spline(x_syn, y_syn, df = 10) 1.017128 1.027162 1.04027 1.032833
       uq      max neval
 1.039956 1.306849   100
</pre></div></div>
</div>
</section>
<section id="Limited-knots">
<h2>Limited knots<a class="headerlink" href="#Limited-knots" title="Link to this heading">¶</a></h2>
<p>R’s <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code> automatically reduces the number of knots when <span class="math notranslate nohighlight">\(N &gt; 49\)</span> (typically to around 50-100) to speed up computation. For <span class="math notranslate nohighlight">\(N=10000\)</span>, <code class="docutils literal notranslate"><span class="pre">R</span></code> uses about 200 knots.</p>
<p>To make a fair speed comparison, we can limit the number of knots in Python as well.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Python Timing with reduced knots</span>
<span class="n">n_syn</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">x_syn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_syn</span><span class="p">))</span>
<span class="n">y_syn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x_syn</span><span class="p">)</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_syn</span><span class="p">)</span>
<span class="n">n_knots_reduced</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># Similar to R&#39;s behavior</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python Timing (n=</span><span class="si">{</span><span class="n">n_syn</span><span class="si">}</span><span class="s2">, n_knots=</span><span class="si">{</span><span class="n">n_knots_reduced</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> SplineFitter(x=x_syn, df=10, n_knots=n_knots_reduced).fit(y_syn)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Python Timing (n=10000, n_knots=200):
87 ms ± 2.89 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">x_syn</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">y_syn</span>
<span class="nf">library</span><span class="p">(</span><span class="n">microbenchmark</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;R Timing (n=%d):\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">x_syn</span><span class="p">)))</span>

<span class="c1"># Fit once to inspect knots</span>
<span class="n">fit_r_syn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">x_syn</span><span class="p">,</span><span class="w"> </span><span class="n">y_syn</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">nknots</span><span class="o">=</span><span class="m">200</span><span class="p">)</span>
<span class="n">n_knots_r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_r_syn</span><span class="o">$</span><span class="n">fit</span><span class="o">$</span><span class="n">nk</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Number of knots used by R: %d\n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">n_knots_r</span><span class="p">))</span>

<span class="nf">microbenchmark</span><span class="p">(</span>
<span class="w">  </span><span class="nf">smooth.spline</span><span class="p">(</span><span class="n">x_syn</span><span class="p">,</span><span class="w"> </span><span class="n">y_syn</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">),</span>
<span class="w">  </span><span class="n">times</span><span class="o">=</span><span class="m">100</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
R Timing (n=10000):
Number of knots used by R: 202
Unit: milliseconds
                                 expr      min       lq     mean   median
 smooth.spline(x_syn, y_syn, df = 10) 29.54396 30.68539 31.72041 30.89628
       uq      max neval
 31.67716 53.50502   100
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">smoothing_spline</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Smoothing Splines: Theory and Implementation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Comparing <code class="docutils literal notranslate"><span class="pre">smoothing_spline</span></code> with R’s <code class="docutils literal notranslate"><span class="pre">smooth.spline</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Setup">Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Loading-the-Data">Loading the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fitting-Smoothing-Splines">Fitting Smoothing Splines</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Speed-Comparison">Speed Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Automatic-Tuning-with-GCV">Automatic Tuning with GCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Another-Example:-Log-Transformation">Another Example: Log-Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Synthetic-Speed-Comparison-(N=500)">Synthetic Speed Comparison (N=500)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Limited-knots">Limited knots</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="theory.html" title="previous chapter">Smoothing Splines: Theory and Implementation</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Jonathan Taylor.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/compare_R.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>